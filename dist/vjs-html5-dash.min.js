/*! vjs-html5-dash - v0.1.0 - 2015-01-13
* Copyright (c) 2015 Christian Pillsbury; Licensed ISC */
!function a(b,c,d){function e(g,h){if(!c[g]){if(!b[g]){var i="function"==typeof require&&require;if(!h&&i)return i(g,!0);if(f)return f(g,!0);var j=new Error("Cannot find module '"+g+"'");throw j.code="MODULE_NOT_FOUND",j}var k=c[g]={exports:{}};b[g][0].call(k.exports,function(a){var c=b[g][1][a];return e(c?c:a)},k,k.exports,a,b,c,d)}return c[g].exports}for(var f="function"==typeof require&&require,g=0;g<d.length;g++)e(d[g]);return e}({1:[function(a,b){(function(a){b.exports="undefined"!=typeof window?window:"undefined"!=typeof a?a:"undefined"!=typeof self?self:{}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],2:[function(a,b){"use strict";function c(a,b){if(!e(a)||!e(b))return!1;for(var c in a)if(a.hasOwnProperty(c)&&a[c]===b)return!0;return!1}function d(a,b,c,d){this.__segmentLoader=a,this.__sourceBufferDataQueue=b,this.__mediaType=c,this.__tech=d}var e=a("./util/existy.js"),f=(a("./util/isFunction.js"),a("./util/extendObject.js")),g=a("./events/EventDispatcherMixin.js"),h=20,i=40;d.prototype.eventList={RECHECK_SEGMENT_LOADING:"recheckSegmentLoading",RECHECK_CURRENT_SEGMENT_LIST:"recheckCurrentSegmentList",LOAD_STATE_CHANGED:"loadStateChanged"},d.prototype.loadStates={NOT_LOADING:-10,WAITING_TO_CHECK:0,CHECKING_STARTED:10,WAITING_TO_DOWNLOAD:20,DOWNLOAD_STARTED:30,ADD_TO_BUFFER_STARTED:40,LOADING_COMPLETE:50},d.prototype.getLoadState=function(){return this.__loadState},d.prototype.setLoadState=function(a){a!==this.__loadState&&c(this.loadStates,a)&&(this.__loadState=a,this.trigger({type:this.eventList.LOAD_STATE_CHANGED,target:this,data:a}))},d.prototype.getMediaType=function(){return this.__mediaType},d.prototype.getSegmentLoader=function(){return this.__segmentLoader},d.prototype.getSourceBufferDataQueue=function(){return this.__sourceBufferDataQueue},d.prototype.startLoadingSegments=function(){this.startLoadingSegmentsForStaticPlaylist()},d.prototype.startLoadingSegmentsForStaticPlaylist=function(){var a=this;this.__recheckSegmentLoadingHandler=function(){a.trigger({type:a.eventList.RECHECK_CURRENT_SEGMENT_LIST,target:a}),a.__checkSegmentLoading(h,i)},this.on(this.eventList.RECHECK_SEGMENT_LOADING,this.__recheckSegmentLoadingHandler),this.__segmentLoader.getCurrentSegmentList().getIsLive()&&this.one(this.eventList.RECHECK_SEGMENT_LOADING,function(){a.__tech.setCurrentTime(a.__sourceBufferDataQueue.getBufferedTimeRangeList().getTimeRangeByIndex(0).getStart())}),this.__checkSegmentLoading(h,i)},d.prototype.stopLoadingSegments=function(){e(this.__recheckSegmentLoadingHandler)&&(this.off(this.eventList.RECHECK_SEGMENT_LOADING,this.__recheckSegmentLoadingHandler),this.__recheckSegmentLoadingHandler=void 0)},d.prototype.__checkSegmentLoading=function(a,b){function c(){var a=Math.floor(1e3*Math.min(n,2));a=Math.floor(1e3*Math.min(n,2)),setTimeout(function(){h.trigger({type:h.eventList.RECHECK_SEGMENT_LOADING,target:h})},a)}var d,f,g,h=this,i=h.__tech,j=h.__segmentLoader,k=h.__sourceBufferDataQueue,l=i.currentTime(),m=j.getCurrentSegmentList(),n=m.getSegmentDuration(),o=m.getTotalDuration(),p=k.getBufferedTimeRangeListAlignedToSegmentDuration(n),q=h.getNextSegmentToLoad(l,m,p),r=q.getStartTime();return d=e(p)&&p.getLength()>0?r-l:0,m.getIsLive()?void(e(p)&&p.getLength()<=0?h.__loadSegmentAtTime(r):(f=j.getLastDownloadRoundTripTimeSpan(),g=n-f,console.log("segmentDownloadDelay: "+g),setTimeout(function(){q=h.getNextSegmentToLoad(l,m,p),r=q.getStartTime(),console.log("downloadPoint: "+r),h.__loadSegmentAtTime(r)},Math.floor(1e3*g)))):r>=o?void c():void(a>d?h.__loadSegmentAtTime(r):b>d?(f=j.getLastDownloadRoundTripTimeSpan(),g=n-f,0>=g?h.__loadSegmentAtTime(r):setTimeout(function(){h.__loadSegmentAtTime(r)},Math.floor(1e3*g))):c())},d.prototype.__loadSegmentAtTime=function(a){var b=this,c=b.__segmentLoader,d=b.__sourceBufferDataQueue,e=c.loadSegmentAtTime(a);return e?(c.one(c.eventList.SEGMENT_LOADED,function(a){console.log("SUCCESSFUL LOADING!"),d.one(d.eventList.QUEUE_EMPTY,function(){b.trigger({type:b.eventList.RECHECK_SEGMENT_LOADING,target:b})}),d.addToQueue(a.data)}),e):e},d.prototype.getNextSegmentToLoad=function(a,b,c){var d,f,g,h=c.getTimeRangeByTime(a);if(!e(h)){if(b.getIsLive()){var i=b.getSegmentByUTCWallClockTime(Date.now());return b.getSegmentByNumber(i.getNumber()-1)}return b.getSegmentByTime(a)}for(g=c.getLength(),f=h.getIndex()+1;g>f;f++)if(d=h,h=c.getTimeRangeByIndex(f),h.getStart()-d.getEnd()>.003)return b.getSegmentByTime(d.getEnd());return b.getSegmentByTime(h.getEnd())},f(d.prototype,g),b.exports=d},{"./events/EventDispatcherMixin.js":9,"./util/existy.js":18,"./util/extendObject.js":19,"./util/isFunction.js":21}],3:[function(a,b){"use strict";function c(a,b,c){var d=a.getMediaSetByType(c).getSourceBufferType(),e=b.addSourceBuffer(d);return new i(e)}function d(a,b,d,e){var f=new h(a,d),g=c(a,b,d);return new j(f,g,d,e)}function e(a,b,c){var e=l.filter(function(b){var c=g(a.getMediaSetByType(b));return c}),f=e.map(function(e){return d(a,b,e,c)});return f}function f(a,b,c){function d(b){var d=b.getSegmentLoader(),e=1,f=d.getCurrentSegmentList().getBandwidth(),g=b.getMediaType();b.on(b.eventList.RECHECK_CURRENT_SEGMENT_LIST,function(){var b,h=a.getMediaSetByType(g),i=c.player().isFullscreen(),j={};j.downloadRateRatio=e,j.currentSegmentListBandwidth=f,j.width=i?window.screen.width:c.player().width(),j.height=i?window.screen.height:c.player().height(),b=k(h,j),d.setCurrentBandwidth(b.getBandwidth())}),d.on(d.eventList.DOWNLOAD_DATA_UPDATE,function(a){e=a.data.playbackTime/a.data.rtt,f=a.data.bandwidth}),b.startLoadingSegments()}function f(){var a=c.el().readyState,b=4===a?1:0;c.setPlaybackRate(b)}this.__tech=c,this.__mediaTypeLoaders=e(a,b,c);var g;for(g=0;g<this.__mediaTypeLoaders.length;g++)d(this.__mediaTypeLoaders[g]);var h,i=["seeking","canplay","canplaythrough"];for(g=0;g<i.length;g++)h=i[g],c.on(h,f)}var g=a("./util/existy.js"),h=a("./segments/SegmentLoader.js"),i=a("./sourceBuffer/SourceBufferDataQueue.js"),j=a("./MediaTypeLoader.js"),k=a("./selectSegmentList.js"),l=a("./manifest/MediaTypes.js");b.exports=f},{"./MediaTypeLoader.js":2,"./manifest/MediaTypes.js":13,"./segments/SegmentLoader.js":15,"./selectSegmentList.js":16,"./sourceBuffer/SourceBufferDataQueue.js":17,"./util/existy.js":18}],4:[function(a,b){"use strict";function c(a,b){var c=this,g=new e(a.src,!1);g.one(g.eventList.MANIFEST_LOADED,function(){var a=new d,e=function(){a.removeEventListener("sourceopen",e,!1),c.__playlistLoader=new f(g,a,b)};a.addEventListener("sourceopen",e,!1),b.setSrc(URL.createObjectURL(a))}),g.load()}var d=a("global/window").MediaSource,e=a("./manifest/ManifestController.js"),f=a("./PlaylistLoader.js");b.exports=c},{"./PlaylistLoader.js":3,"./manifest/ManifestController.js":12,"global/window":1}],5:[function(a,b){"use strict";var c,d,e,f,g,h,i,j,k,l=a("../../xmlfun.js"),m=a("./util.js"),n=a("../../util/isArray.js"),o=a("../../util/isFunction.js"),p=a("../../util/isString.js"),q=m.parseRootUrl,r=function(a){var b=[a].concat(l.getAncestors(a)),c=!1,d=b.map(function(a){if(c)return"";if(!a.hasChildNodes())return"";for(var b,d=0;d<a.childNodes.length;d++)if(b=a.childNodes.item(d),"BaseURL"===b.nodeName){var e=b.childNodes.item(0),f=e.wholeText.trim();return 0===f.indexOf("http://")&&(c=!0),e.wholeText.trim()}return""}),e=d.reverse().join("");return e?e:q(a.baseURI)},s=l.getInheritableAttribute("width"),t=l.getInheritableAttribute("height"),u=l.getInheritableAttribute("frameRate"),v=l.getInheritableAttribute("mimeType"),w=l.getInheritableAttribute("codecs"),x=l.getMultiLevelElementList("SegmentTemplate"),y=l.getAttrFn("mediaPresentationDuration"),z=l.getAttrFn("type"),A=l.getAttrFn("minimumUpdatePeriod"),B=l.getAttrFn("availabilityStartTime"),C=l.getAttrFn("suggestedPresentationDelay"),D=l.getAttrFn("timeShiftBufferDepth"),E=l.getAttrFn("id"),F=l.getAttrFn("bandwidth"),G=l.getAttrFn("initialization"),H=l.getAttrFn("media"),I=l.getAttrFn("duration"),J=l.getAttrFn("timescale"),K=l.getAttrFn("presentationTimeOffset"),L=l.getAttrFn("startNumber");c=function(a){return{xml:a,getPeriods:l.preApplyArgsFn(j,a,"Period",d),getMediaPresentationDuration:l.preApplyArgsFn(y,a),getType:l.preApplyArgsFn(z,a),getMinimumUpdatePeriod:l.preApplyArgsFn(A,a),getAvailabilityStartTime:l.preApplyArgsFn(B,a),getSuggestedPresentationDelay:l.preApplyArgsFn(C,a),getTimeShiftBufferDepth:l.preApplyArgsFn(D,a)}},d=function(a){return{xml:a,getAdaptationSets:l.preApplyArgsFn(j,a,"AdaptationSet",e),getAdaptationSetByType:function(b){return i(b,a)},getMpd:l.preApplyArgsFn(k,a,"MPD",c)}},e=function(a){return{xml:a,getRepresentations:l.preApplyArgsFn(j,a,"Representation",f),getSegmentTemplate:function(){return g(x(a))},getPeriod:l.preApplyArgsFn(k,a,"Period",d),getMpd:l.preApplyArgsFn(k,a,"MPD",c),getMimeType:l.preApplyArgsFn(v,a)}},f=function(a){return{xml:a,getSegmentTemplate:function(){return g(x(a))},getAdaptationSet:l.preApplyArgsFn(k,a,"AdaptationSet",e),getPeriod:l.preApplyArgsFn(k,a,"Period",d),getMpd:l.preApplyArgsFn(k,a,"MPD",c),getId:l.preApplyArgsFn(E,a),getWidth:l.preApplyArgsFn(s,a),getHeight:l.preApplyArgsFn(t,a),getFrameRate:l.preApplyArgsFn(u,a),getBandwidth:l.preApplyArgsFn(F,a),getCodecs:l.preApplyArgsFn(w,a),getBaseUrl:l.preApplyArgsFn(r,a),getMimeType:l.preApplyArgsFn(v,a)}},g=function(a){function b(a,b){if(!n(b))return void 0;if(!o(a))return void 0;{var c,d;b.length}for(c=0;c<b.length;c++)if(d=a(b[c]),p(d)&&""!==d)return d;return void 0}return{xml:a,getAdaptationSet:l.preApplyArgsFn(k,a[0],"AdaptationSet",e),getPeriod:l.preApplyArgsFn(k,a[0],"Period",d),getMpd:l.preApplyArgsFn(k,a[0],"MPD",c),getInitialization:l.preApplyArgsFn(b,G,a),getMedia:l.preApplyArgsFn(b,H,a),getDuration:l.preApplyArgsFn(b,I,a),getTimescale:l.preApplyArgsFn(b,J,a),getPresentationTimeOffset:l.preApplyArgsFn(b,K,a),getStartNumber:l.preApplyArgsFn(b,L,a)}},i=function(a,b){for(var c,d,f,g=b.getElementsByTagName("AdaptationSet"),h=0;h<g.length;h++)if(c=g.item(h),d=c.getElementsByTagName("Representation")[0],f=v(d),f&&f.indexOf(a)>=0)return e(c);return null},h=function(a){return j(a,"MPD",c)[0]},j=function(a,b,c){var d=Array.prototype.slice.call(a.getElementsByTagName(b));if("function"==typeof c){var e=d.map(c);return e}return d},k=function(a,b,c){return b&&a&&a.parentNode&&a.parentNode.hasOwnProperty("nodeName")?a.parentNode.nodeName===b?"function"==typeof c?c(a.parentNode):a.parentNode:k(a.parentNode,b,c):null},b.exports=h},{"../../util/isArray.js":20,"../../util/isFunction.js":21,"../../util/isString.js":23,"../../xmlfun.js":25,"./util.js":6}],6:[function(a,b){"use strict";var c,d,e,f=31536e3,g=2592e3,h=86400,i=3600,j=60,k=60,l=1e3,m=/^P(([\d.]*)Y)?(([\d.]*)M)?(([\d.]*)D)?T?(([\d.]*)H)?(([\d.]*)M)?(([\d.]*)S)?/,n=/^([0-9]{4})-([0-9]{2})-([0-9]{2})T([0-9]{2}):([0-9]{2})(?::([0-9]*)(\.[0-9]*)?)?(?:([+-])([0-9]{2})([0-9]{2}))?/;c=function(a){return"string"!=typeof a?"":-1===a.indexOf("/")?"":(-1!==a.indexOf("?")&&(a=a.substring(0,a.indexOf("?"))),a.substring(0,a.lastIndexOf("/")+1))},d=function(a){if(!a)return Number.NaN;var b=m.exec(a);return b?parseFloat(b[2]||0)*f+parseFloat(b[4]||0)*g+parseFloat(b[6]||0)*h+parseFloat(b[8]||0)*i+parseFloat(b[10]||0)*j+parseFloat(b[12]||0):Number.NaN},e=function(a){var b,c=n.exec(a);if(b=Date.UTC(parseInt(c[1],10),parseInt(c[2],10)-1,parseInt(c[3],10),parseInt(c[4],10),parseInt(c[5],10),c[6]&&parseInt(c[6],10)||0,c[7]&&parseFloat(c[7])*l||0),c[9]&&c[10]){var d=parseInt(c[9],10)*k+parseInt(c[10],10);b+=("+"===c[8]?-1:1)*d*j*l}return b};var o={parseRootUrl:c,parseMediaPresentationDuration:d,parseDateTime:e};b.exports=o},{}],7:[function(a,b){"use strict";function c(a){return a&&a.getSegmentTemplate()?d(a):void 0}var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t=a("../../util/existy.js"),u=a("../../xmlfun.js"),v=a("../mpd/util.js").parseMediaPresentationDuration,w=a("../mpd/util.js").parseDateTime,x=a("./segmentTemplate");h=function(a){var b=a.getCodecs(),c=a.getMimeType(),d=b.split(".").map(function(a){return a.replace(/^0+(?!\.|$)/,"")}),e=d.join(".");return c+';codecs="'+e+'"'},i=function(a){return"dynamic"===a.getMpd().getType()},j=function(a){var b=a.getBandwidth();return t(b)?Number(b):void 0},k=function(a){var b=a.getWidth();return t(b)?Number(b):void 0},l=function(a){var b=a.getHeight();return t(b)?Number(b):void 0},m=function(a){var b=a.getMpd().getMediaPresentationDuration(),c=t(b)?v(b):Number.NaN,d=Number(a.getSegmentTemplate().getPresentationTimeOffset())||0;return t(c)?Number(c-d):Number.NaN},n=function(a){var b=a.getMpd().getAvailabilityStartTime(),c=w(b);return c},o=function(a){var b=a.getMpd().getTimeShiftBufferDepth(),c=v(b);return c},p=function(a){var b=a.getSegmentTemplate();return Number(b.getDuration())/Number(b.getTimescale())},q=function(a){return Math.ceil(m(a)/p(a))},r=function(a){return Number(a.getSegmentTemplate().getStartNumber())},s=function(a){return q(a)+r(a)-1},d=function(a){return{getType:u.preApplyArgsFn(h,a),getIsLive:u.preApplyArgsFn(i,a),getBandwidth:u.preApplyArgsFn(j,a),getHeight:u.preApplyArgsFn(l,a),getWidth:u.preApplyArgsFn(k,a),getTotalDuration:u.preApplyArgsFn(m,a),getSegmentDuration:u.preApplyArgsFn(p,a),getUTCWallClockStartTime:u.preApplyArgsFn(n,a),getTimeShiftBufferDepth:u.preApplyArgsFn(o,a),getTotalSegmentCount:u.preApplyArgsFn(q,a),getStartNumber:u.preApplyArgsFn(r,a),getEndNumber:u.preApplyArgsFn(s,a),getInitialization:function(){var b={};return b.getUrl=function(){var b=a.getBaseUrl(),c=a.getId(),d=a.getSegmentTemplate().getInitialization(),e=x.replaceIDForTemplate(d,c);return e=x.replaceTokenForTemplate(e,"Bandwidth",a.getBandwidth()),b+e},b},getSegmentByNumber:function(b){return e(a,b)},getSegmentByTime:function(b){return f(a,b)},getSegmentByUTCWallClockTime:function(b){return g(a,b)}}},e=function(a,b){var c={};return c.getUrl=function(){var c,d=a.getBaseUrl(),e=a.getSegmentTemplate().getMedia(),f=x.replaceIDForTemplate(e,a.getId());return c=x.replaceTokenForTemplate(f,"Number",b),c=x.replaceTokenForTemplate(c,"Bandwidth",a.getBandwidth()),d+c},c.getStartTime=function(){return(b-r(a))*p(a)},c.getUTCWallClockStartTime=function(){return n(a)+Math.round((b-r(a))*p(a)*1e3)},c.getDuration=function(){var c,d,e,f=p(a);return s(a)===b?(d=Number(m(a)),e=1e3,c=d*e%(f*e)/e):c=f,c},c.getNumber=function(){return b},c},f=function(a,b){var c=p(a),d=r(a)||0,f=Math.floor(b/c)+d,g=e(a,f);return g.getStartTime()+g.getDuration()-b<=.003?e(a,f+1):g},g=function(a,b){var c,d=n(a);return Number.isNaN(d)?null:(c=(b-d)/1e3,Number.isNaN(c)?null:f(a,c))},b.exports=c},{"../../util/existy.js":18,"../../xmlfun.js":25,"../mpd/util.js":6,"./segmentTemplate":8}],8:[function(a,b){"use strict";var c,d,e,f,g;d=function(a,b){for(;a.length<b;)a="0"+a;return a},e=function(a,b,c){for(var e,f,g,h,i=0,j=0,k=b.length,l="%0",m=l.length;;){if(i=a.indexOf("$"+b),0>i)return a;if(j=a.indexOf("$",i+k),0>j)return a;if(e=a.indexOf(l,i+k),e>i&&j>e)switch(f=a.charAt(j-1),g=parseInt(a.substring(e+m,j-1),10),f){case"d":case"i":case"u":h=d(c.toString(),g);break;case"x":h=d(c.toString(16),g);break;case"X":h=d(c.toString(16),g).toUpperCase();break;case"o":h=d(c.toString(8),g);break;default:return console.log("Unsupported/invalid IEEE 1003.1 format identifier string in URL"),a}else h=c;a=a.substring(0,i)+h+a.substring(j+1)}},f=function(a){return a.split("$$").join("$")},g=function(a,b){if(null===b||-1===a.indexOf("$RepresentationID$"))return a;var c=b.toString();return a.split("$RepresentationID$").join(c)},c={zeroPadToLength:d,replaceTokenForTemplate:e,unescapeDollarsInTemplate:f,replaceIDForTemplate:g},b.exports=c},{}],9:[function(a,b){"use strict";var c=a("./eventManager.js"),d={trigger:function(a){c.trigger(this,a)},one:function(a,b){c.one(this,a,b)},on:function(a,b){c.on(this,a,b)},off:function(a,b){c.off(this,a,b)}};b.exports=d},{"./eventManager.js":10}],10:[function(a,b){"use strict";var c=a("global/window").videojs,d={trigger:c.trigger,one:c.one,on:c.on,off:c.off};b.exports=d},{"global/window":1}],11:[function(a){(function(){"use strict";function b(a){return d.MediaSource?/application\/dash\+xml/.test(a.type)?g.MAYBE_HANDLE_SOURCE:/\.mpd$/i.test(a.src)?g.MAYBE_HANDLE_SOURCE:g.DOESNT_HANDLE_SOURCE:g.DOESNT_HANDLE_SOURCE}function c(a,b){return new f(a,b)}var d=a("global/window"),e=d.videojs,f=a("./SourceHandler"),g={DOESNT_HANDLE_SOURCE:"",MAYBE_HANDLE_SOURCE:"maybe"};if(!e)throw new Error("The video.js library must be included to use this MPEG-DASH source handler.");e.Html5.registerSourceHandler({canHandleSource:b,handleSource:c},0)}).call(this)},{"./SourceHandler":4,"global/window":1}],12:[function(a,b){"use strict";function c(a,b){this.__autoLoad=i(b),this.setSourceUri(a)}function d(a){this.__adaptationSet=a}var e,f,g,h=a("../util/existy.js"),i=a("../util/truthy.js"),j=a("../util/isString.js"),k=a("../util/isFunction.js"),l=a("../util/isArray.js"),m=a("./loadManifest.js"),n=a("../util/extendObject.js"),o=a("../dash/mpd/util.js").parseMediaPresentationDuration,p=a("../events/EventDispatcherMixin.js"),q=a("../dash/segments/getSegmentListForRepresentation.js"),r=a("../dash/mpd/getMpd.js"),s=a("./MediaTypes.js"),t=s[0];f=function(a,b){if(!j(a))return t;var c=g(b,function(b){return!!a&&a.indexOf(b)>=0});return h(c)?c:t},e=function(a){var b=a.getCodecs(),c=a.getMimeType(),d=b.split(".").map(function(a){return a.replace(/^0+(?!\.|$)/,"")}),e=d.join(".");return c+';codecs="'+e+'"'},g=function(a,b){if(!l(a)||!k(b))return void 0;var c,d,e=a.length;for(c=0;e>c;c++)if(d=a[c],b(d,c,a))return d;return void 0},c.prototype.eventList={MANIFEST_LOADED:"manifestLoaded"},c.prototype.getSourceUri=function(){return this.__sourceUri},c.prototype.setSourceUri=function(a){if(a!==this.__sourceUri){if(!a)return void this.__clearSourceUri();this.__clearCurrentUpdateInterval(),this.__sourceUri=a,this.__autoLoad&&this.load()}},c.prototype.__clearSourceUri=function(){this.__sourceUri=null,this.__clearCurrentUpdateInterval()},c.prototype.load=function(){var a=this;m(a.__sourceUri,function(b){a.__manifest=b.manifestXml,a.__setupUpdateInterval(),a.trigger({type:a.eventList.MANIFEST_LOADED,target:a,data:a.__manifest})})},c.prototype.__clearCurrentUpdateInterval=function(){h(this.__updateInterval)&&clearInterval(this.__updateInterval)},c.prototype.__setupUpdateInterval=function(){if(this.__updateInterval&&this.__clearCurrentUpdateInterval(),this.getShouldUpdate()){var a=this,b=2,c=Math.max(this.getUpdateRate(),b);this.__updateInterval=setInterval(function(){a.load()},1e3*c)}},c.prototype.getPlaylistType=function(){var a=r(this.__manifest).getType();return a},c.prototype.getUpdateRate=function(){var a=r(this.__manifest).getMinimumUpdatePeriod(),b=o(a);return b},c.prototype.getShouldUpdate=function(){var a="dynamic"===this.getPlaylistType(),b=this.getUpdateRate()>0;return a&&b},c.prototype.getMpd=function(){return r(this.__manifest)},c.prototype.getMediaSetByType=function(a){if(s.indexOf(a)<0)throw new Error("Invalid type. Value must be one of: "+s.join(", "));var b=r(this.__manifest).getPeriods()[0].getAdaptationSets(),c=g(b,function(b){return f(b.getMimeType(),s)===a});return h(c)?new d(c):null},c.prototype.getMediaSets=function(){var a=r(this.__manifest).getPeriods()[0].getAdaptationSets(),b=a.map(function(a){return new d(a)});return b},n(c.prototype,p),d.prototype.getMediaType=function(){var a=f(this.getMimeType(),s);return a},d.prototype.getMimeType=function(){var a=this.__adaptationSet.getMimeType();return a},d.prototype.getSourceBufferType=function(){var a=this.__adaptationSet.getRepresentations()[0],b=e(a);return b},d.prototype.getTotalDuration=function(){var a=this.__adaptationSet.getRepresentations()[0],b=q(a),c=b.getTotalDuration();return c},d.prototype.getUTCWallClockStartTime=function(){var a=this.__adaptationSet.getRepresentations()[0],b=q(a),c=b.getUTCWallClockStartTime();return c},d.prototype.getTotalSegmentCount=function(){var a=this.__adaptationSet.getRepresentations()[0],b=q(a),c=b.getTotalSegmentCount();return c},d.prototype.getSegmentDuration=function(){var a=this.__adaptationSet.getRepresentations()[0],b=q(a),c=b.getSegmentDuration();return c},d.prototype.getSegmentListStartNumber=function(){var a=this.__adaptationSet.getRepresentations()[0],b=q(a),c=b.getStartNumber();return c},d.prototype.getSegmentListEndNumber=function(){var a=this.__adaptationSet.getRepresentations()[0],b=q(a),c=b.getEndNumber();return c},d.prototype.getSegmentLists=function(){var a=this.__adaptationSet.getRepresentations(),b=a.map(q);return b},d.prototype.getSegmentListByBandwidth=function(a){var b=this.__adaptationSet.getRepresentations(),c=g(b,function(b){var c=b.getBandwidth();return Number(c)===Number(a)}),d=q(c);return d},d.prototype.getAvailableBandwidths=function(){return this.__adaptationSet.getRepresentations().map(function(a){return Number(a.getBandwidth())}).filter(function(a){return h(a)})},b.exports=c},{"../dash/mpd/getMpd.js":5,"../dash/mpd/util.js":6,"../dash/segments/getSegmentListForRepresentation.js":7,"../events/EventDispatcherMixin.js":9,"../util/existy.js":18,"../util/extendObject.js":19,"../util/isArray.js":20,"../util/isFunction.js":21,"../util/isString.js":23,"../util/truthy.js":24,"./MediaTypes.js":13,"./loadManifest.js":14}],13:[function(a,b){b.exports=["video","audio"]},{}],14:[function(a,b){"use strict";function c(a,b){var c,e=(d(a),new XMLHttpRequest);c=function(){e.status<200||e.status>299||"function"==typeof b&&b({manifestXml:e.responseXML})};try{e.onload=c,e.open("GET",a,!0),e.send()}catch(f){e.onerror()}}var d=a("../dash/mpd/util.js").parseRootUrl;b.exports=c},{"../dash/mpd/util.js":6}],15:[function(a,b){function c(a,b){if(!e(a))throw new Error("SegmentLoader must be initialized with a manifestController!");if(!e(b))throw new Error("SegmentLoader must be initialized with a mediaType!");this.__manifest=a,this.__mediaType=b,this.__currentBandwidth=this.getCurrentBandwidth(),this.__currentBandwidthChanged=!0}var d,e=a("../util/existy.js"),f=a("../util/isNumber.js"),g=a("../util/extendObject.js"),h=a("../events/EventDispatcherMixin.js"),i=3,j=250;d=function(a,b,c,e){var f=this;f.__lastDownloadCompleteTime=null;var g=new XMLHttpRequest,h=a.getUrl();g.open("GET",h,!0),g.responseType="arraybuffer",g.onload=function(){return g.status<200||g.status>299?(console.log("Failed to load Segment @ URL: "+a.getUrl()),void(c>0?setTimeout(function(){d.call(f,a,b,c-1,e)},e):console.log("FAILED TO LOAD SEGMENT EVEN AFTER RETRIES"))):(f.__lastDownloadCompleteTime=Number((new Date).getTime()/1e3),void("function"==typeof b&&b.call(f,g.response)))},g.onerror=function(){console.log("Failed to load Segment @ URL: "+a.getUrl()),c>0?setTimeout(function(){d.call(f,a,b,c-1,e)},e):console.log("FAILED TO LOAD SEGMENT EVEN AFTER RETRIES")},f.__lastDownloadStartTime=Number((new Date).getTime()/1e3),g.send()},c.prototype.eventList={INITIALIZATION_LOADED:"initializationLoaded",SEGMENT_LOADED:"segmentLoaded",DOWNLOAD_DATA_UPDATE:"downloadDataUpdate"},c.prototype.__getMediaSet=function(){var a=this.__manifest.getMediaSetByType(this.__mediaType);return a},c.prototype.__getDefaultSegmentList=function(){var a=this.__getMediaSet().getSegmentLists()[0];return a},c.prototype.getCurrentBandwidth=function(){return f(this.__currentBandwidth)||(this.__currentBandwidth=this.__getDefaultSegmentList().getBandwidth()),this.__currentBandwidth},c.prototype.setCurrentBandwidth=function(a){if(!f(a))throw new Error("SegmentLoader::setCurrentBandwidth() expects a numeric value for bandwidth!");var b=this.getAvailableBandwidths();if(b.indexOf(a)<0)throw new Error("SegmentLoader::setCurrentBandwidth() must be set to one of the following values: "+b.join(", "));a!==this.__currentBandwidth&&(this.__currentBandwidthChanged=!0,this.__currentBandwidth=a)},c.prototype.getCurrentSegmentList=function(){var a=this.__getMediaSet().getSegmentListByBandwidth(this.getCurrentBandwidth());return a},c.prototype.getAvailableBandwidths=function(){var a=this.__getMediaSet().getAvailableBandwidths();return a},c.prototype.getStartNumber=function(){var a=this.__getMediaSet().getSegmentListStartNumber();return a},c.prototype.getCurrentSegment=function(){var a=this.getCurrentSegmentList().getSegmentByNumber(this.__currentSegmentNumber);return a},c.prototype.getCurrentSegmentNumber=function(){return this.__currentSegmentNumber},c.prototype.getCurrentSegmentStartTime=function(){return this.getCurrentSegment().getStartNumber()},c.prototype.getEndNumber=function(){var a=this.__getMediaSet().getSegmentListEndNumber();return a},c.prototype.getLastDownloadStartTime=function(){return e(this.__lastDownloadStartTime)?this.__lastDownloadStartTime:-1},c.prototype.getLastDownloadCompleteTime=function(){return e(this.__lastDownloadCompleteTime)?this.__lastDownloadCompleteTime:-1},c.prototype.getLastDownloadRoundTripTimeSpan=function(){return this.getLastDownloadCompleteTime()-this.getLastDownloadStartTime()},c.prototype.loadInitialization=function(){var a=this,b=this.getCurrentSegmentList(),c=b.getInitialization();return c?(d.call(this,c,function(b){var c=new Uint8Array(b);a.trigger({type:a.eventList.INITIALIZATION_LOADED,target:a,data:c})}),!0):!1},c.prototype.loadNextSegment=function(){var a=e(this.__currentSegmentNumber),b=a?this.getStartNumber():this.__currentSegmentNumber+1;return this.loadSegmentAtNumber(b)},c.prototype.loadSegmentAtNumber=function(a){var b=this,c=this.getCurrentSegmentList();if(a>this.getEndNumber())return!1;var e=c.getSegmentByNumber(a);return this.__currentBandwidthChanged?(this.one(this.eventList.INITIALIZATION_LOADED,function(a){var c=a.data;b.__currentBandwidthChanged=!1,d.call(b,e,function(a){var d=new Uint8Array(a);b.__currentSegmentNumber=e.getNumber(),b.trigger({type:b.eventList.SEGMENT_LOADED,target:b,data:[c,d]})},i,j)}),this.loadInitialization()):d.call(b,e,function(a){b.trigger({type:b.eventList.DOWNLOAD_DATA_UPDATE,target:b,data:{rtt:b.getLastDownloadRoundTripTimeSpan(),playbackTime:e.getDuration(),bandwidth:c.getBandwidth()}});var d=new Uint8Array(a);b.__currentSegmentNumber=e.getNumber(),b.trigger({type:b.eventList.SEGMENT_LOADED,target:b,data:d})},i,j),!0},c.prototype.loadSegmentAtTime=function(a){var b=this,c=this.getCurrentSegmentList();if(a>c.getTotalDuration())return!1;var e=c.getSegmentByTime(a);return this.__currentBandwidthChanged?(this.one(this.eventList.INITIALIZATION_LOADED,function(a){var c=a.data;b.__currentBandwidthChanged=!1,d.call(b,e,function(a){var d=new Uint8Array(a);b.__currentSegmentNumber=e.getNumber(),b.trigger({type:b.eventList.SEGMENT_LOADED,target:b,data:[c,d]})},i,j)}),this.loadInitialization()):d.call(b,e,function(a){b.trigger({type:b.eventList.DOWNLOAD_DATA_UPDATE,target:b,data:{rtt:b.getLastDownloadRoundTripTimeSpan(),playbackTime:e.getDuration(),bandwidth:c.getBandwidth()}});var d=new Uint8Array(a);b.__currentSegmentNumber=e.getNumber(),b.trigger({type:b.eventList.SEGMENT_LOADED,target:b,data:d})},i,j),!0},g(c.prototype,h),b.exports=c},{"../events/EventDispatcherMixin.js":9,"../util/existy.js":18,"../util/extendObject.js":19,"../util/isNumber.js":22}],16:[function(a,b){"use strict";function c(a,b){var c=a.getBandwidth(),d=b.getBandwidth();return c-d}function d(a,b){var c=a.getWidth()||0,d=b.getWidth()||0;return c-d}function e(a,b){var e=d(a,b);return 0!==e?e:c(a,b)}function f(a,b,c){var d=a.getWidth()||0,e=a.getHeight()||0;return b>=d&&c>=e}function g(a,b,c){var d=a.getBandwidth(),e=d/b;return c>=e}function h(a,b){function d(a){return f(a,n,o)}function h(a){return g(a,m,l)}var i,j,k,l=b.downloadRateRatio,m=b.currentSegmentListBandwidth,n=b.width,o=b.height,p=a.getSegmentLists().sort(c),q=a.getSegmentLists().sort(e);return j=q.filter(d),i=p.filter(h),k=j[j.length-1]||i[i.length-1]||p[0]}b.exports=h},{}],17:[function(a,b){"use strict";function c(a,b,c){return g(c)||(c=function(a){return a}),{getStart:function(){return c(a.buffered.start(b))},getEnd:function(){return c(a.buffered.end(b))},getIndex:function(){return b}}}function d(a,b){return{getLength:function(){return a.buffered.length},getTimeRangeByIndex:function(d){return c(a,d,b)},getTimeRangeByTime:function(d,e){i(e)||(e=.15);var f,g,h=a.buffered.length;for(g=0;h>g;g++){if(f=c(a,g,b),f.getStart()-e>d)return null;if(f.getEnd()+e>d)return f}return null}}}function e(a,b){function c(a){return Math.round(a/b)*b}return d(a,c)}function f(a){if(!a)throw new Error("The sourceBuffer constructor argument cannot be null.");var b=this,c=[];a.addEventListener("updateend",function(a){return a.target.updating?void 0:(b.trigger({type:b.eventList.SEGMENT_ADDED_TO_BUFFER,target:b}),b.__dataQueue.length<=0?void b.trigger({type:b.eventList.QUEUE_EMPTY,target:b}):void b.__sourceBuffer.appendBuffer(b.__dataQueue.shift()))}),this.__dataQueue=c,this.__sourceBuffer=a}var g=a("../util/isFunction.js"),h=a("../util/isArray.js"),i=a("../util/isNumber.js"),j=a("../util/existy.js"),k=a("../util/extendObject.js"),l=a("../events/EventDispatcherMixin.js");f.prototype.eventList={QUEUE_EMPTY:"queueEmpty",SEGMENT_ADDED_TO_BUFFER:"segmentAddedToBuffer"},f.prototype.addToQueue=function(a){var b;!j(a)||h(a)&&a.length<=0||(h(a)||(a=[a]),0!==this.__dataQueue.length||this.__sourceBuffer.updating||(b=a.shift()),this.__dataQueue=this.__dataQueue.concat(a),j(b)&&this.__sourceBuffer.appendBuffer(b))},f.prototype.clearQueue=function(){this.__dataQueue=[]},f.prototype.getBufferedTimeRangeList=function(){return d(this.__sourceBuffer)},f.prototype.getBufferedTimeRangeListAlignedToSegmentDuration=function(a){return e(this.__sourceBuffer,a)},k(f.prototype,l),b.exports=f},{"../events/EventDispatcherMixin.js":9,"../util/existy.js":18,"../util/extendObject.js":19,"../util/isArray.js":20,"../util/isFunction.js":21,"../util/isNumber.js":22}],18:[function(a,b){"use strict";function c(a){return null!==a&&void 0!==a}b.exports=c},{}],19:[function(a,b){"use strict";var c=function(a){var b,c,d=Array.prototype.slice.call(arguments,1),e=d.length;for(b=0;e>b;b++)if(c=d[b])for(var f in c)a[f]=c[f];return a};b.exports=c},{}],20:[function(a,b){"use strict";function c(a){return"[object Array]"===e.toString.call(a)}var d=function(){},e=new d;b.exports=c},{}],21:[function(a,b){"use strict";var c=function(){},d=new c,e=function(a){return"function"==typeof a};e(/x/)&&(e=function(a){return"function"==typeof a&&"[object Function]"===d.toString.call(a)}),b.exports=e},{}],22:[function(a,b){"use strict";function c(a){return"number"==typeof a||a&&"object"==typeof a&&"[object Number]"===e.toString.call(a)||!1}var d=function(){},e=new d;b.exports=c},{}],23:[function(a,b){"use strict";var c=function(){},d=new c,e=function(a){return"string"==typeof a||a&&"object"==typeof a&&"[object String]"===d.toString.call(a)||!1};b.exports=e},{}],24:[function(a,b){"use strict";function c(a){return a!==!1&&d(a)}var d=a("./existy.js");b.exports=c},{"./existy.js":18}],25:[function(a,b){"use strict";function c(a){return a!==!1&&e(a)}function d(a){var b=Array.prototype.slice.call(arguments,1);return function(){return a.apply(this,b)}}var e=a("./util/existy.js"),f=a("./util/isFunction.js"),g=a("./util/isString.js"),h=function(a,b){var c=[];return f(b)||(b=function(){return!1}),function d(a){b(a,c)||e(a)&&e(a.parentNode)&&(c.push(a.parentNode),d(a.parentNode))}(a),c},i=function(a){return function(b){return b.getElementsByTagName(a)}},j=function(a,b){return"string"!=typeof a||""===a?void 0:function(c){return e(c)&&e(c.hasAttribute)&&e(c.getAttribute)?e(b)?c.getAttribute(a)===b:c.hasAttribute(a):!1}},k=function(a){return g(a)?function(b){return e(b)&&f(b.getAttribute)?b.getAttribute(a):void 0}:void 0},l=function(a){return g(a)&&""!==a?function b(c){return e(c)&&e(c.hasAttribute)&&e(c.getAttribute)?c.hasAttribute(a)?c.getAttribute(a):e(c.parentNode)?b(c.parentNode):void 0:void 0}:void 0},m=function(a,b){return g(a)&&""!==a?(f(b)||(b=function(){return!1}),function c(d){if(!e(d)||!e(d.getElementsByTagName))return void 0;if(b(d))return void 0;var f=d.getElementsByTagName(a);return e(f)&&f.length>0?f[0]:e(d.parentNode)?c(d.parentNode):void 0}):void 0},n=function(a){return g(a)&&""!==a?function(b){if(!e(b)||!f(b.getElementsByTagName))return void 0;
var c,d=b.getElementsByTagName(a);return!e(d)||d.length<=0?void 0:(c=d[0],c.parentNode===b?c:void 0)}:void 0},o=function(a,b){if(!g(a)||""===a)return void 0;f(b)||(b=function(){return!1});var c=n(a);return function(a){for(var d,f=a,g=[];e(f)&&!b(f);)d=c(f),e(d)&&g.push(d),f=f.parentNode;return g.length>0?g:void 0}},p={};p.existy=e,p.truthy=c,p.getNodeListByName=i,p.hasMatchingAttribute=j,p.getInheritableAttribute=l,p.getAncestors=h,p.getAttrFn=k,p.preApplyArgsFn=d,p.getInheritableElement=m,p.getMultiLevelElementList=o,b.exports=p},{"./util/existy.js":18,"./util/isFunction.js":21,"./util/isString.js":23}]},{},[11]);