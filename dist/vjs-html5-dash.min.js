/*! vjs-html5-dash - v0.1.0 - 2014-12-19
* Copyright (c) 2014 Christian Pillsbury; Licensed ISC */
!function a(b,c,d){function e(g,h){if(!c[g]){if(!b[g]){var i="function"==typeof require&&require;if(!h&&i)return i(g,!0);if(f)return f(g,!0);var j=new Error("Cannot find module '"+g+"'");throw j.code="MODULE_NOT_FOUND",j}var k=c[g]={exports:{}};b[g][0].call(k.exports,function(a){var c=b[g][1][a];return e(c?c:a)},k,k.exports,a,b,c,d)}return c[g].exports}for(var f="function"==typeof require&&require,g=0;g<d.length;g++)e(d[g]);return e}({1:[function(a,b){(function(a){b.exports="undefined"!=typeof window?window:"undefined"!=typeof a?a:"undefined"!=typeof self?self:{}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],2:[function(a,b){"use strict";function c(a,b,c,d){this.__segmentLoader=a,this.__sourceBufferDataQueue=b,this.__mediaType=c,this.__tech=d}var d=a("./util/existy.js"),e=(a("./util/isFunction.js"),a("./util/extendObject.js")),f=a("./events/EventDispatcherMixin.js"),g=20,h=40;c.prototype.eventList={RECHECK_SEGMENT_LOADING:"recheckSegmentLoading",RECHECK_CURRENT_SEGMENT_LIST:"recheckCurrentSegmentList"},c.prototype.getMediaType=function(){return this.__mediaType},c.prototype.getSegmentLoader=function(){return this.__segmentLoader},c.prototype.getSourceBufferDataQueue=function(){return this.__sourceBufferDataQueue},c.prototype.startLoadingSegments=function(){var a=this;this.__recheckSegmentLoadingHandler=function(){a.trigger({type:a.eventList.RECHECK_CURRENT_SEGMENT_LIST,target:a}),a.__checkSegmentLoading(g,h)},this.on(this.eventList.RECHECK_SEGMENT_LOADING,this.__recheckSegmentLoadingHandler),this.__checkSegmentLoading(g,h)},c.prototype.stopLoadingSegments=function(){d(this.__recheckSegmentLoadingHandler)&&(this.off(this.eventList.RECHECK_SEGMENT_LOADING,this.__recheckSegmentLoadingHandler),this.__recheckSegmentLoadingHandler=void 0)},c.prototype.__checkSegmentLoading=function(a,b){function c(){var a=Math.floor(1e3*Math.min(l,2));a=Math.floor(1e3*Math.min(l,2)),setTimeout(function(){f.trigger({type:f.eventList.RECHECK_SEGMENT_LOADING,target:f})},a)}var d,e,f=this,g=f.__tech,h=f.__segmentLoader,i=f.__sourceBufferDataQueue,j=g.currentTime(),k=i.determineAmountBufferedFromTime(j),l=h.getCurrentSegmentList().getSegmentDuration(),m=h.getCurrentSegmentList().getTotalDuration(),n=j+k+l/4;return n>=m?void c():void(0>=k?f.__loadSegmentAtTime(j):a>k?f.__loadSegmentAtTime(n):b>k?(d=h.getLastDownloadRoundTripTimeSpan(),e=l-d,0>=e?f.__loadSegmentAtTime(n):setTimeout(function(){j=g.currentTime(),k=i.determineAmountBufferedFromTime(j),n=j+k+l/2,f.__loadSegmentAtTime(n)},Math.floor(1e3*e))):c())},c.prototype.__loadSegmentAtTime=function(a){var b=this,c=b.__segmentLoader,d=b.__sourceBufferDataQueue,e=c.loadSegmentAtTime(a);return e?(c.one(c.eventList.SEGMENT_LOADED,function(a){d.one(d.eventList.QUEUE_EMPTY,function(){b.trigger({type:b.eventList.RECHECK_SEGMENT_LOADING,target:b})}),d.addToQueue(a.data)}),e):e},e(c.prototype,f),b.exports=c},{"./events/EventDispatcherMixin.js":9,"./util/existy.js":18,"./util/extendObject.js":19,"./util/isFunction.js":21}],3:[function(a,b){"use strict";function c(a,b,c){var d=a.getMediaSetByType(c).getSourceBufferType(),e=b.addSourceBuffer(d);return new i(e)}function d(a,b,d,e){var f=new h(a,d),g=c(a,b,d);return new j(f,g,d,e)}function e(a,b,c){var e=l.filter(function(b){var c=g(a.getMediaSetByType(b));return c}),f=e.map(function(e){return d(a,b,e,c)});return f}function f(a,b,c){this.__tech=c,this.__mediaTypeLoaders=e(a,b,c),this.__mediaTypeLoaders.forEach(function(b){var d=b.getSegmentLoader(),e=1,f=d.getCurrentSegmentList().getBandwidth(),g=b.getMediaType();b.on(b.eventList.RECHECK_CURRENT_SEGMENT_LIST,function(){var b,h=a.getMediaSetByType(g),i=c.player().isFullscreen(),j={};j.downloadRateRatio=e,j.currentSegmentListBandwidth=f,j.width=i?window.screen.width:c.player().width(),j.height=i?window.screen.height:c.player().height(),b=k(h,j),d.setCurrentBandwidth(b.getBandwidth())}),d.on(d.eventList.DOWNLOAD_DATA_UPDATE,function(a){e=a.data.playbackTime/a.data.rtt,f=a.data.bandwidth}),b.startLoadingSegments()});var d=["seeking","canplay","canplaythrough"];d.forEach(function(a){c.on(a,function(){var a=c.el().readyState,b=4===a?1:0;c.setPlaybackRate(b)})})}var g=a("./util/existy.js"),h=a("./segments/SegmentLoader.js"),i=a("./sourceBuffer/SourceBufferDataQueue.js"),j=a("./MediaTypeLoader.js"),k=a("./selectSegmentList.js"),l=a("./manifest/MediaTypes.js");b.exports=f},{"./MediaTypeLoader.js":2,"./manifest/MediaTypes.js":13,"./segments/SegmentLoader.js":15,"./selectSegmentList.js":16,"./sourceBuffer/SourceBufferDataQueue.js":17,"./util/existy.js":18}],4:[function(a,b){"use strict";function c(a,b){var c=this,g=new e(a.src,!1);g.load(function(){var a=new d,e=function(){a.removeEventListener("sourceopen",e,!1),c.__playlistLoader=new f(g,a,b)};a.addEventListener("sourceopen",e,!1),b.setSrc(URL.createObjectURL(a))})}var d=a("global/window").MediaSource,e=a("./manifest/ManifestController.js"),f=a("./PlaylistLoader.js");b.exports=c},{"./PlaylistLoader.js":3,"./manifest/ManifestController.js":12,"global/window":1}],5:[function(a,b){"use strict";var c,d,e,f,g,h,i,j,k,l=a("../../xmlfun.js"),m=a("./util.js"),n=m.parseRootUrl,o=function(a){var b=[a].concat(l.getAncestors(a)),c=!1,d=b.map(function(a){if(c)return"";if(!a.hasChildNodes())return"";for(var b,d=0;d<a.childNodes.length;d++)if(b=a.childNodes.item(d),"BaseURL"===b.nodeName){var e=b.childNodes.item(0),f=e.wholeText.trim();return 0===f.indexOf("http://")&&(c=!0),e.wholeText.trim()}return""}),e=d.reverse().join("");return e?e:n(a.baseURI)},p=["AdaptationSet","Representation","SubRepresentation"],q=function(a){return p.indexOf(a.nodeName)>=0},r=function(a){return!q(a)},s=l.getInheritableAttribute("width"),t=l.getInheritableAttribute("height"),u=l.getInheritableAttribute("frameRate"),v=l.getInheritableAttribute("mimeType"),w=l.getInheritableAttribute("codecs"),x=l.getInheritableElement("SegmentTemplate",r),y=l.getAttrFn("mediaPresentationDuration"),z=l.getAttrFn("type"),A=l.getAttrFn("minimumUpdatePeriod"),B=l.getAttrFn("id"),C=l.getAttrFn("bandwidth"),D=l.getAttrFn("initialization"),E=l.getAttrFn("media"),F=l.getAttrFn("duration"),G=l.getAttrFn("timescale"),H=l.getAttrFn("presentationTimeOffset"),I=l.getAttrFn("startNumber");c=function(a){return{xml:a,getPeriods:l.preApplyArgsFn(j,a,"Period",d),getMediaPresentationDuration:l.preApplyArgsFn(y,a),getType:l.preApplyArgsFn(z,a),getMinimumUpdatePeriod:l.preApplyArgsFn(A,a)}},d=function(a){return{xml:a,getAdaptationSets:l.preApplyArgsFn(j,a,"AdaptationSet",e),getAdaptationSetByType:function(b){return i(b,a)},getMpd:l.preApplyArgsFn(k,a,"MPD",c)}},e=function(a){return{xml:a,getRepresentations:l.preApplyArgsFn(j,a,"Representation",f),getSegmentTemplate:function(){return g(x(a))},getPeriod:l.preApplyArgsFn(k,a,"Period",d),getMpd:l.preApplyArgsFn(k,a,"MPD",c),getMimeType:l.preApplyArgsFn(v,a)}},f=function(a){return{xml:a,getSegmentTemplate:function(){return g(x(a))},getAdaptationSet:l.preApplyArgsFn(k,a,"AdaptationSet",e),getPeriod:l.preApplyArgsFn(k,a,"Period",d),getMpd:l.preApplyArgsFn(k,a,"MPD",c),getId:l.preApplyArgsFn(B,a),getWidth:l.preApplyArgsFn(s,a),getHeight:l.preApplyArgsFn(t,a),getFrameRate:l.preApplyArgsFn(u,a),getBandwidth:l.preApplyArgsFn(C,a),getCodecs:l.preApplyArgsFn(w,a),getBaseUrl:l.preApplyArgsFn(o,a),getMimeType:l.preApplyArgsFn(v,a)}},g=function(a){return{xml:a,getAdaptationSet:l.preApplyArgsFn(k,a,"AdaptationSet",e),getPeriod:l.preApplyArgsFn(k,a,"Period",d),getMpd:l.preApplyArgsFn(k,a,"MPD",c),getInitialization:l.preApplyArgsFn(D,a),getMedia:l.preApplyArgsFn(E,a),getDuration:l.preApplyArgsFn(F,a),getTimescale:l.preApplyArgsFn(G,a),getPresentationTimeOffset:l.preApplyArgsFn(H,a),getStartNumber:l.preApplyArgsFn(I,a)}},i=function(a,b){for(var c,d,f,g=b.getElementsByTagName("AdaptationSet"),h=0;h<g.length;h++)if(c=g.item(h),d=c.getElementsByTagName("Representation")[0],f=v(d),f&&f.indexOf(a)>=0)return e(c);return null},h=function(a){return j(a,"MPD",c)[0]},j=function(a,b,c){var d=Array.prototype.slice.call(a.getElementsByTagName(b));if("function"==typeof c){var e=d.map(c);return e}return d},k=function(a,b,c){return b&&a&&a.parentNode&&a.parentNode.hasOwnProperty("nodeName")?a.parentNode.nodeName===b?"function"==typeof c?c(a.parentNode):a.parentNode:k(a.parentNode,b,c):null},b.exports=h},{"../../xmlfun.js":25,"./util.js":6}],6:[function(a,b){"use strict";var c,d,e=31536e3,f=2592e3,g=86400,h=3600,i=60,j=/^P(([\d.]*)Y)?(([\d.]*)M)?(([\d.]*)D)?T?(([\d.]*)H)?(([\d.]*)M)?(([\d.]*)S)?/;c=function(a){return"string"!=typeof a?"":-1===a.indexOf("/")?"":(-1!==a.indexOf("?")&&(a=a.substring(0,a.indexOf("?"))),a.substring(0,a.lastIndexOf("/")+1))},d=function(a){var b=j.exec(a);return parseFloat(b[2]||0)*e+parseFloat(b[4]||0)*f+parseFloat(b[6]||0)*g+parseFloat(b[8]||0)*h+parseFloat(b[10]||0)*i+parseFloat(b[12]||0)};var k={parseRootUrl:c,parseMediaPresentationDuration:d};b.exports=k},{}],7:[function(a,b){"use strict";function c(a){return a&&a.getSegmentTemplate()?d(a):void 0}var d,e,f,g,h,i,j,k,l,m,n,o,p=a("../../util/existy.js"),q=a("../../xmlfun.js"),r=a("../mpd/util.js").parseMediaPresentationDuration,s=a("./segmentTemplate");g=function(a){var b=a.getCodecs(),c=a.getMimeType(),d=b.split(".").map(function(a){return a.replace(/^0+(?!\.|$)/,"")}),e=d.join(".");return c+';codecs="'+e+'"'},h=function(a){var b=a.getBandwidth();return p(b)?Number(b):void 0},i=function(a){var b=a.getWidth();return p(b)?Number(b):void 0},j=function(a){var b=a.getHeight();return p(b)?Number(b):void 0},k=function(a){var b=a.getMpd().getMediaPresentationDuration(),c=p(b)?Number(r(b)):Number.NaN,d=Number(a.getSegmentTemplate().getPresentationTimeOffset());return p(c)?Number(c-d):Number.NaN},l=function(a){var b=a.getSegmentTemplate();return Number(b.getDuration())/Number(b.getTimescale())},m=function(a){return Math.ceil(k(a)/l(a))},n=function(a){return Number(a.getSegmentTemplate().getStartNumber())},o=function(a){return m(a)+n(a)-1},d=function(a){return{getType:q.preApplyArgsFn(g,a),getBandwidth:q.preApplyArgsFn(h,a),getHeight:q.preApplyArgsFn(j,a),getWidth:q.preApplyArgsFn(i,a),getTotalDuration:q.preApplyArgsFn(k,a),getSegmentDuration:q.preApplyArgsFn(l,a),getTotalSegmentCount:q.preApplyArgsFn(m,a),getStartNumber:q.preApplyArgsFn(n,a),getEndNumber:q.preApplyArgsFn(o,a),getInitialization:function(){var b={};return b.getUrl=function(){var b=a.getBaseUrl(),c=a.getId(),d=a.getSegmentTemplate().getInitialization(),e=s.replaceIDForTemplate(d,c);return e=s.replaceTokenForTemplate(e,"Bandwidth",a.getBandwidth()),b+e},b},getSegmentByNumber:function(b){return e(a,b)},getSegmentByTime:function(b){return f(a,b)}}},e=function(a,b){var c={};return c.getUrl=function(){var c,d=a.getBaseUrl(),e=a.getSegmentTemplate().getMedia(),f=s.replaceIDForTemplate(e,a.getId());return c=s.replaceTokenForTemplate(f,"Number",b),c=s.replaceTokenForTemplate(c,"Bandwidth",a.getBandwidth()),d+c},c.getStartTime=function(){return b*l(a)},c.getDuration=function(){var c,d,e,f=l(a);return o(a)===b?(d=Number(k(a)),e=1e3,c=d*e%(f*e)/e):c=f,c},c.getNumber=function(){return b},c},f=function(a,b){var c=l(a),d=Math.floor(b/c),f=e(a,d);return f},b.exports=c},{"../../util/existy.js":18,"../../xmlfun.js":25,"../mpd/util.js":6,"./segmentTemplate":8}],8:[function(a,b){"use strict";var c,d,e,f,g;d=function(a,b){for(;a.length<b;)a="0"+a;return a},e=function(a,b,c){for(var e,f,g,h,i=0,j=0,k=b.length,l="%0",m=l.length;;){if(i=a.indexOf("$"+b),0>i)return a;if(j=a.indexOf("$",i+k),0>j)return a;if(e=a.indexOf(l,i+k),e>i&&j>e)switch(f=a.charAt(j-1),g=parseInt(a.substring(e+m,j-1),10),f){case"d":case"i":case"u":h=d(c.toString(),g);break;case"x":h=d(c.toString(16),g);break;case"X":h=d(c.toString(16),g).toUpperCase();break;case"o":h=d(c.toString(8),g);break;default:return console.log("Unsupported/invalid IEEE 1003.1 format identifier string in URL"),a}else h=c;a=a.substring(0,i)+h+a.substring(j+1)}},f=function(a){return a.split("$$").join("$")},g=function(a,b){if(null===b||-1===a.indexOf("$RepresentationID$"))return a;var c=b.toString();return a.split("$RepresentationID$").join(c)},c={zeroPadToLength:d,replaceTokenForTemplate:e,unescapeDollarsInTemplate:f,replaceIDForTemplate:g},b.exports=c},{}],9:[function(a,b){"use strict";var c=a("./eventManager.js"),d={trigger:function(a){c.trigger(this,a)},one:function(a,b){c.one(this,a,b)},on:function(a,b){c.on(this,a,b)},off:function(a,b){c.off(this,a,b)}};b.exports=d},{"./eventManager.js":10}],10:[function(a,b){"use strict";var c=a("global/window").videojs,d={trigger:c.trigger,one:c.one,on:c.on,off:c.off};b.exports=d},{"global/window":1}],11:[function(a){(function(){"use strict";function b(a){var b="",c="maybe",e=b;return d.MediaSource?/application\/dash\+xml/.test(a.type)?(console.log("matched type"),c):/\.mpd$/i.test(a.src)?(console.log("matched extension"),c):e:b}function c(a,b){return new f(a,b)}var d=a("global/window"),e=d.videojs,f=a("./SourceHandler");if(!e)throw new Error("The video.js library must be included to use this MPEG-DASH source handler.");e.Html5.registerSourceHandler({canHandleSource:b,handleSource:c},0)}).call(this)},{"./SourceHandler":4,"global/window":1}],12:[function(a,b){"use strict";function c(a,b){this.__autoLoad=h(b),this.setSourceUri(a)}function d(a){this.__adaptationSet=a}var e,f,g=a("../util/existy.js"),h=a("../util/truthy.js"),i=a("../util/isString.js"),j=a("../util/isFunction.js"),k=a("./loadManifest.js"),l=a("../util/extendObject.js"),m=a("../events/EventDispatcherMixin.js"),n=a("../dash/segments/getSegmentListForRepresentation.js"),o=a("../dash/mpd/getMpd.js"),p=a("./MediaTypes.js"),q=p[0];f=function(a,b){if(!i(a))return q;var c=b.find(function(b){return!!a&&a.indexOf(b)>=0});return g(c)?c:q},e=function(a){var b=a.getCodecs(),c=a.getMimeType(),d=b.split(".").map(function(a){return a.replace(/^0+(?!\.|$)/,"")}),e=d.join(".");return c+';codecs="'+e+'"'},c.prototype.eventList={MANIFEST_LOADED:"manifestLoaded"},c.prototype.getSourceUri=function(){return this.__sourceUri},c.prototype.setSourceUri=function(a){if(a!==this.__sourceUri){if(!a)return void this.__clearSourceUri();this.__clearCurrentUpdateInterval(),this.__sourceUri=a,this.__autoLoad&&this.load()}},c.prototype.__clearSourceUri=function(){this.__sourceUri=null,this.__clearCurrentUpdateInterval()},c.prototype.load=function(a){var b=this;k(b.__sourceUri,function(c){b.__manifest=c.manifestXml,b.__setupUpdateInterval(),b.trigger({type:b.eventList.MANIFEST_LOADED,target:b,data:b.__manifest}),j(a)&&a(c.manifestXml)})},c.prototype.__clearCurrentUpdateInterval=function(){g(this.__updateInterval)&&clearInterval(this.__updateInterval)},c.prototype.__setupUpdateInterval=function(){if(this.__updateInterval&&a.__clearCurrentUpdateInterval(),this.getShouldUpdate()){var a=this,b=2,c=Math.max(this.getUpdateRate(),b);this.__updateInterval=setInterval(function(){a.load()},c)}},c.prototype.getMediaSetByType=function(a){if(p.indexOf(a)<0)throw new Error("Invalid type. Value must be one of: "+p.join(", "));var b=o(this.__manifest).getPeriods()[0].getAdaptationSets(),c=b.find(function(b){return f(b.getMimeType(),p)===a});return g(c)?new d(c):null},c.prototype.getMediaSets=function(){var a=o(this.__manifest).getPeriods()[0].getAdaptationSets(),b=a.map(function(a){return new d(a)});return b},c.prototype.getStreamType=function(){var a=o(this.__manifest).getType();return a},c.prototype.getUpdateRate=function(){var a=o(this.__manifest).getMinimumUpdatePeriod();return Number(a)},c.prototype.getShouldUpdate=function(){var a="dynamic"===this.getStreamType(),b=this.getUpdateRate()>0;return a&&b},l(c.prototype,m),d.prototype.getMediaType=function(){var a=f(this.getMimeType(),p);return a},d.prototype.getMimeType=function(){var a=this.__adaptationSet.getMimeType();return a},d.prototype.getSourceBufferType=function(){var a=this.__adaptationSet.getRepresentations()[0],b=e(a);return b},d.prototype.getTotalDuration=function(){var a=this.__adaptationSet.getRepresentations()[0],b=n(a),c=b.getTotalDuration();return c},d.prototype.getTotalSegmentCount=function(){var a=this.__adaptationSet.getRepresentations()[0],b=n(a),c=b.getTotalSegmentCount();return c},d.prototype.getSegmentDuration=function(){var a=this.__adaptationSet.getRepresentations()[0],b=n(a),c=b.getSegmentDuration();return c},d.prototype.getSegmentListStartNumber=function(){var a=this.__adaptationSet.getRepresentations()[0],b=n(a),c=b.getStartNumber();return c},d.prototype.getSegmentListEndNumber=function(){var a=this.__adaptationSet.getRepresentations()[0],b=n(a),c=b.getEndNumber();return c},d.prototype.getSegmentLists=function(){var a=this.__adaptationSet.getRepresentations(),b=a.map(n);return b},d.prototype.getSegmentListByBandwidth=function(a){var b=this.__adaptationSet.getRepresentations(),c=b.find(function(b){var c=b.getBandwidth();return Number(c)===Number(a)}),d=n(c);return d},d.prototype.getAvailableBandwidths=function(){return this.__adaptationSet.getRepresentations().map(function(a){return Number(a.getBandwidth())}).filter(function(a){return g(a)})},b.exports=c},{"../dash/mpd/getMpd.js":5,"../dash/segments/getSegmentListForRepresentation.js":7,"../events/EventDispatcherMixin.js":9,"../util/existy.js":18,"../util/extendObject.js":19,"../util/isFunction.js":21,"../util/isString.js":23,"../util/truthy.js":24,"./MediaTypes.js":13,"./loadManifest.js":14}],13:[function(a,b){b.exports=["video","audio"]},{}],14:[function(a,b){"use strict";function c(a,b){var c,e=(d(a),new XMLHttpRequest);c=function(){e.status<200||e.status>299||"function"==typeof b&&b({manifestXml:e.responseXML})};try{e.onload=c,e.open("GET",a,!0),e.send()}catch(f){e.onerror()}}var d=a("../dash/mpd/util.js").parseRootUrl;b.exports=c},{"../dash/mpd/util.js":6}],15:[function(a,b){function c(a,b){if(!e(a))throw new Error("SegmentLoader must be initialized with a manifestController!");if(!e(b))throw new Error("SegmentLoader must be initialized with a mediaType!");this.__manifest=a,this.__mediaType=b,this.__currentBandwidth=this.getCurrentBandwidth(),this.__currentBandwidthChanged=!0}var d,e=a("../util/existy.js"),f=a("../util/isNumber.js"),g=a("../util/extendObject.js"),h=a("../events/EventDispatcherMixin.js"),i=3,j=250;d=function(a,b,c,e){var f=this;f.__lastDownloadCompleteTime=null;var g=new XMLHttpRequest,h=a.getUrl();g.open("GET",h,!0),g.responseType="arraybuffer",g.onload=function(){return g.status<200||g.status>299?(console.log("Failed to load Segment @ URL: "+a.getUrl()),void(c>0?setTimeout(function(){d.call(f,a,b,c-1,e)},e):console.log("FAILED TO LOAD SEGMENT EVEN AFTER RETRIES"))):(f.__lastDownloadCompleteTime=Number((new Date).getTime()/1e3),void("function"==typeof b&&b.call(f,g.response)))},g.onerror=function(){console.log("Failed to load Segment @ URL: "+a.getUrl()),c>0?setTimeout(function(){d.call(f,a,b,c-1,e)},e):console.log("FAILED TO LOAD SEGMENT EVEN AFTER RETRIES")},f.__lastDownloadStartTime=Number((new Date).getTime()/1e3),g.send()},c.prototype.eventList={INITIALIZATION_LOADED:"initializationLoaded",SEGMENT_LOADED:"segmentLoaded",DOWNLOAD_DATA_UPDATE:"downloadDataUpdate"},c.prototype.__getMediaSet=function(){var a=this.__manifest.getMediaSetByType(this.__mediaType);return a},c.prototype.__getDefaultSegmentList=function(){var a=this.__getMediaSet().getSegmentLists()[0];return a},c.prototype.getCurrentBandwidth=function(){return f(this.__currentBandwidth)||(this.__currentBandwidth=this.__getDefaultSegmentList().getBandwidth()),this.__currentBandwidth},c.prototype.setCurrentBandwidth=function(a){if(!f(a))throw new Error("SegmentLoader::setCurrentBandwidth() expects a numeric value for bandwidth!");var b=this.getAvailableBandwidths();if(b.indexOf(a)<0)throw new Error("SegmentLoader::setCurrentBandwidth() must be set to one of the following values: "+b.join(", "));a!==this.__currentBandwidth&&(this.__currentBandwidthChanged=!0,this.__currentBandwidth=a)},c.prototype.getCurrentSegmentList=function(){var a=this.__getMediaSet().getSegmentListByBandwidth(this.getCurrentBandwidth());return a},c.prototype.getAvailableBandwidths=function(){var a=this.__getMediaSet().getAvailableBandwidths();return a},c.prototype.getStartNumber=function(){var a=this.__getMediaSet().getSegmentListStartNumber();return a},c.prototype.getCurrentSegment=function(){var a=this.getCurrentSegmentList().getSegmentByNumber(this.__currentSegmentNumber);return a},c.prototype.getCurrentSegmentNumber=function(){return this.__currentSegmentNumber},c.prototype.getCurrentSegmentStartTime=function(){return this.getCurrentSegment().getStartNumber()},c.prototype.getEndNumber=function(){var a=this.__getMediaSet().getSegmentListEndNumber();return a},c.prototype.getLastDownloadStartTime=function(){return e(this.__lastDownloadStartTime)?this.__lastDownloadStartTime:-1},c.prototype.getLastDownloadCompleteTime=function(){return e(this.__lastDownloadCompleteTime)?this.__lastDownloadCompleteTime:-1},c.prototype.getLastDownloadRoundTripTimeSpan=function(){return this.getLastDownloadCompleteTime()-this.getLastDownloadStartTime()},c.prototype.loadInitialization=function(){var a=this,b=this.getCurrentSegmentList(),c=b.getInitialization();return c?(d.call(this,c,function(b){var c=new Uint8Array(b);a.trigger({type:a.eventList.INITIALIZATION_LOADED,target:a,data:c})}),!0):!1},c.prototype.loadNextSegment=function(){var a=e(this.__currentSegmentNumber),b=a?this.getStartNumber():this.__currentSegmentNumber+1;return this.loadSegmentAtNumber(b)},c.prototype.loadSegmentAtNumber=function(a){var b=this,c=this.getCurrentSegmentList();if(console.log("BANDWIDTH OF SEGMENT BEING REQUESTED: "+c.getBandwidth()),a>this.getEndNumber())return!1;var e=c.getSegmentByNumber(a);return this.__currentBandwidthChanged?(this.one(this.eventList.INITIALIZATION_LOADED,function(a){var c=a.data;b.__currentBandwidthChanged=!1,d.call(b,e,function(a){var d=new Uint8Array(a);b.__currentSegmentNumber=e.getNumber(),b.trigger({type:b.eventList.SEGMENT_LOADED,target:b,data:[c,d]})},i,j)}),this.loadInitialization()):d.call(b,e,function(a){b.trigger({type:b.eventList.DOWNLOAD_DATA_UPDATE,target:b,data:{rtt:b.getLastDownloadRoundTripTimeSpan(),playbackTime:e.getDuration(),bandwidth:c.getBandwidth()}});var d=new Uint8Array(a);b.__currentSegmentNumber=e.getNumber(),b.trigger({type:b.eventList.SEGMENT_LOADED,target:b,data:d})},i,j),!0},c.prototype.loadSegmentAtTime=function(a){var b=this,c=this.getCurrentSegmentList();if(console.log("BANDWIDTH OF SEGMENT BEING REQUESTED: "+c.getBandwidth()),a>c.getTotalDuration())return!1;var e=c.getSegmentByTime(a);return this.__currentBandwidthChanged?(this.one(this.eventList.INITIALIZATION_LOADED,function(a){var c=a.data;b.__currentBandwidthChanged=!1,d.call(b,e,function(a){var d=new Uint8Array(a);b.__currentSegmentNumber=e.getNumber(),b.trigger({type:b.eventList.SEGMENT_LOADED,target:b,data:[c,d]})},i,j)}),this.loadInitialization()):d.call(b,e,function(a){b.trigger({type:b.eventList.DOWNLOAD_DATA_UPDATE,target:b,data:{rtt:b.getLastDownloadRoundTripTimeSpan(),playbackTime:e.getDuration(),bandwidth:c.getBandwidth()}});var d=new Uint8Array(a);b.__currentSegmentNumber=e.getNumber(),b.trigger({type:b.eventList.SEGMENT_LOADED,target:b,data:d})},i,j),!0},g(c.prototype,h),b.exports=c},{"../events/EventDispatcherMixin.js":9,"../util/existy.js":18,"../util/extendObject.js":19,"../util/isNumber.js":22}],16:[function(a,b){"use strict";function c(a,b){var c=a.getBandwidth(),d=b.getBandwidth();return c-d}function d(a,b){var c=a.getWidth()||0,d=b.getWidth()||0;return c-d}function e(a,b){var e=d(a,b);return 0!==e?e:c(a,b)}function f(a,b,c){var d=a.getWidth()||0,e=a.getHeight()||0;return b>=d&&c>=e}function g(a,b,c){var d=a.getBandwidth(),e=d/b;return c>=e}function h(a,b){function d(a){return f(a,n,o)}function h(a){return g(a,m,l)}var i,j,k,l=b.downloadRateRatio,m=b.currentSegmentListBandwidth,n=b.width,o=b.height,p=a.getSegmentLists().sort(c),q=a.getSegmentLists().sort(e);return j=q.filter(d),i=p.filter(h),k=j[j.length-1]||i[i.length-1]||p[0]}b.exports=h},{}],17:[function(a,b){"use strict";function c(a){if(!a)throw new Error("The sourceBuffer constructor argument cannot be null.");var b=this,c=[];a.addEventListener("updateend",function(a){return a.target.updating?void 0:(b.trigger({type:b.eventList.SEGMENT_ADDED_TO_BUFFER,target:b}),b.__dataQueue.length<=0?void b.trigger({type:b.eventList.QUEUE_EMPTY,target:b}):void b.__sourceBuffer.appendBuffer(b.__dataQueue.shift()))}),this.__dataQueue=c,this.__sourceBuffer=a}function d(a,b,c){var d,f,g=a.length,h=0;for(h;g>h;h++){if(d=a.start(h),f=a.end(h),b>=d&&f>=b)return e(c)?c(d,f,b):!0;if(d>b)break}return e(c)?c(-1,-1,b):!1}var e=a("../util/isFunction.js"),f=a("../util/isArray.js"),g=a("../util/existy.js"),h=a("../util/extendObject.js"),i=a("../events/EventDispatcherMixin.js");c.prototype.eventList={QUEUE_EMPTY:"queueEmpty",SEGMENT_ADDED_TO_BUFFER:"segmentAddedToBuffer"},c.prototype.addToQueue=function(a){var b;!g(a)||f(a)&&a.length<=0||(f(a)||(a=[a]),0!==this.__dataQueue.length||this.__sourceBuffer.updating||(b=a.shift()),this.__dataQueue=this.__dataQueue.concat(a),g(b)&&this.__sourceBuffer.appendBuffer(b))},c.prototype.clearQueue=function(){this.__dataQueue=[]},c.prototype.hasBufferedDataForTime=function(a){return d(this.__sourceBuffer.buffered,a,function(a,b){return a>=0||b>=0})},c.prototype.determineAmountBufferedFromTime=function(a){return d(this.__sourceBuffer.buffered,a,function(a,b,c){return b-c})},h(c.prototype,i),b.exports=c},{"../events/EventDispatcherMixin.js":9,"../util/existy.js":18,"../util/extendObject.js":19,"../util/isArray.js":20,"../util/isFunction.js":21}],18:[function(a,b){"use strict";function c(a){return null!==a&&void 0!==a}b.exports=c},{}],19:[function(a,b){"use strict";var c=function(a){return Array.prototype.slice.call(arguments,1).forEach(function(b){if(b)for(var c in b)a[c]=b[c]}),a};b.exports=c},{}],20:[function(a,b){"use strict";function c(a){return"[object Array]"===e.toString.call(a)}var d=function(){},e=new d;b.exports=c},{}],21:[function(a,b){"use strict";var c=function(){},d=new c,e=function(a){return"function"==typeof a};e(/x/)&&(e=function(a){return"function"==typeof a&&"[object Function]"===d.toString.call(a)}),b.exports=e},{}],22:[function(a,b){"use strict";function c(a){return"number"==typeof a||a&&"object"==typeof a&&"[object Number]"===e.toString.call(a)||!1}var d=function(){},e=new d;b.exports=c},{}],23:[function(a,b){"use strict";var c=function(){},d=new c,e=function(a){return"string"==typeof a||a&&"object"==typeof a&&"[object String]"===d.toString.call(a)||!1};b.exports=e},{}],24:[function(a,b){"use strict";function c(a){return a!==!1&&d(a)}var d=a("./existy.js");b.exports=c},{"./existy.js":18}],25:[function(a,b){"use strict";function c(a){return a!==!1&&e(a)}function d(a){var b=Array.prototype.slice.call(arguments,1);return function(){return a.apply(this,b)}}var e=a("./util/existy.js"),f=a("./util/isFunction.js"),g=a("./util/isString.js"),h=function(a,b){var c=[];return f(b)||(b=function(){return!1}),function d(a){b(a,c)||e(a)&&e(a.parentNode)&&(c.push(a.parentNode),d(a.parentNode))}(a),c},i=function(a){return function(b){return b.getElementsByTagName(a)}},j=function(a,b){return"string"!=typeof a||""===a?void 0:function(c){return e(c)&&e(c.hasAttribute)&&e(c.getAttribute)?e(b)?c.getAttribute(a)===b:c.hasAttribute(a):!1}},k=function(a){return g(a)?function(b){return e(b)&&f(b.getAttribute)?b.getAttribute(a):void 0}:void 0},l=function(a){return g(a)&&""!==a?function b(c){return e(c)&&e(c.hasAttribute)&&e(c.getAttribute)?c.hasAttribute(a)?c.getAttribute(a):e(c.parentNode)?b(c.parentNode):void 0:void 0}:void 0},m=function(a,b){return g(a)&&""!==a?(f(b)||(b=function(){return!1}),function c(d){if(!e(d)||!e(d.getElementsByTagName))return void 0;if(b(d))return void 0;var f=d.getElementsByTagName(a);return e(f)&&f.length>0?f[0]:e(d.parentNode)?c(d.parentNode):void 0}):void 0},n={};n.existy=e,n.truthy=c,n.getNodeListByName=i,n.hasMatchingAttribute=j,n.getInheritableAttribute=l,n.getAncestors=h,n.getAttrFn=k,n.preApplyArgsFn=d,n.getInheritableElement=m,b.exports=n},{"./util/existy.js":18,"./util/isFunction.js":21,"./util/isString.js":23}]},{},[11]);