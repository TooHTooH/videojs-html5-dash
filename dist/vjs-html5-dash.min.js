/*! vjs-html5-dash - v0.1.0 - 2014-12-08
* Copyright (c) 2014 Christian Pillsbury; Licensed ISC */
!function a(b,c,d){function e(g,h){if(!c[g]){if(!b[g]){var i="function"==typeof require&&require;if(!h&&i)return i(g,!0);if(f)return f(g,!0);var j=new Error("Cannot find module '"+g+"'");throw j.code="MODULE_NOT_FOUND",j}var k=c[g]={exports:{}};b[g][0].call(k.exports,function(a){var c=b[g][1][a];return e(c?c:a)},k,k.exports,a,b,c,d)}return c[g].exports}for(var f="function"==typeof require&&require,g=0;g<d.length;g++)e(d[g]);return e}({1:[function(a,b){"use strict";function c(a,b){return b in a&&"function"==typeof a[b]}function d(a,b){if(!a||!b||a.length!==b.length)return null;for(var c={},d=0;d<a.length;d++)c[a[d]]=b[d];return c}function e(a,b,c){var d=a.prototype[b];a.prototype[b]=function(a){if(d.apply(this,Array.prototype.slice.call(arguments)),a in c){var b=Array.prototype.slice.call(arguments,1),e=[c[a]].concat(b);d.apply(this,Array.prototype.slice.call(e))}}}function f(a){if(c(a,h))return a[h];if(c(a,i)){var b=a[i],f=d(j,k);return e(b,"addEventListener",f),e(b,"removeEventListener",f),b}return function(){throw new Error("MediaSource doesn't appear to be supported in your environment")}}var g=a("./window.js"),h="MediaSource",i="WebKitMediaSource",j=["sourceopen","sourceclose","sourceended"],k=["webkitsourceopen","webkitsourceclose","webkitsourceended"],l=f(g);b.exports=l},{"./window.js":3}],2:[function(a){(function(){"use strict";function b(a,b){a.MediaSource=b}var c=a("./window.js"),d=a("./MediaSource");b(c,d)}).call(this)},{"./MediaSource":1,"./window.js":3}],3:[function(a,b){(function(a){"use strict";b.exports=a}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],4:[function(a,b){"use strict";function c(a){if(!a)return null;var b=a.getAttribute("codecs"),c=j.getInheritableAttribute("mimeType")(a),d=b.split(".").map(function(a){return a.replace(/^0+(?!\.|$)/,"")}),e=d.join(".");return c+';codecs="'+e+'"'}function d(a,b){a.one(a.eventList.INITIALIZATION_LOADED,function(c){b.one(b.eventList.QUEUE_EMPTY,function(){e(a,b)}),b.addToQueue(c.data)}),a.loadInitialization()}function e(a,b){a.on(a.eventList.SEGMENT_LOADED,function c(d){b.one(b.eventList.QUEUE_EMPTY,function(){var b=a.loadNextSegment();b||a.off(a.eventList.SEGMENT_LOADED,c)}),b.addToQueue(d.data)}),a.loadNextSegment()}function f(a,b){console.log("START");var c=new i,d=function(){c.removeEventListener("sourceopen",d,!1),g("video",a,c),g("audio",a,c)};c.addEventListener("sourceopen",d,!1),b.setSrc(URL.createObjectURL(c))}function g(a,b,e){var f=l(b).getPeriods()[0].getAdaptationSetByType(a),g=new n(f),h=c(g.getCurrentRepresentation().xml),i=e.addSourceBuffer(h),j=new o(i),k=m(f.getRepresentations()[0]);console.log("Type: "+a),console.log("Total Duration: "+k.getTotalDuration()),console.log("Segment Duration: "+k.getSegmentDuration()),console.log("Total Segment Count: "+k.getTotalSegmentCount()),console.log("Start Number: "+k.getStartNumber()),console.log("End Number: "+k.getEndNumber()),d(g,j)}function h(a,b){k(a.src,function(a){f(a.manifestXml,b)})}var i=a("./window.js").MediaSource,j=a("./xmlfun.js"),k=a("./manifest/loadManifest.js"),l=a("./dash/mpd/getMpd.js"),m=a("./dash/segments/getSegmentListForRepresentation.js"),n=a("./segments/SegmentLoader.js"),o=a("./sourceBuffer/SourceBufferDataQueue.js");b.exports=h},{"./dash/mpd/getMpd.js":5,"./dash/segments/getSegmentListForRepresentation.js":7,"./manifest/loadManifest.js":12,"./segments/SegmentLoader.js":13,"./sourceBuffer/SourceBufferDataQueue.js":14,"./window.js":16,"./xmlfun.js":17}],5:[function(a,b){"use strict";var c,d,e,f,g,h,i,j,k,l=a("../../xmlfun.js"),m=a("./util.js"),n=m.parseRootUrl,o=function(a){var b=[a].concat(l.getAncestors(a)),c=!1,d=b.map(function(a){if(c)return"";if(!a.hasChildNodes())return"";for(var b,d=0;d<a.childNodes.length;d++)if(b=a.childNodes.item(d),"BaseURL"===b.nodeName){var e=b.childNodes.item(0),f=e.wholeText.trim();return 0===f.indexOf("http://")&&(c=!0),e.wholeText.trim()}return""}),e=d.reverse().join("");return e?e:n(a.baseURI)},p=["AdaptationSet","Representation","SubRepresentation"],q=function(a){return p.indexOf(a.nodeName)>=0},r=function(a){return!q(a)},s=l.getInheritableAttribute("width"),t=l.getInheritableAttribute("height"),u=l.getInheritableAttribute("frameRate"),v=l.getInheritableAttribute("mimeType"),w=l.getInheritableAttribute("codecs"),x=l.getInheritableElement("SegmentTemplate",r),y=l.getAttrFn("mediaPresentationDuration"),z=l.getAttrFn("id"),A=l.getAttrFn("bandwidth"),B=l.getAttrFn("initialization"),C=l.getAttrFn("media"),D=l.getAttrFn("duration"),E=l.getAttrFn("timescale"),F=l.getAttrFn("presentationTimeOffset"),G=l.getAttrFn("startNumber");c=function(a){return{xml:a,getPeriods:l.preApplyArgsFn(j,a,"Period",d),getMediaPresentationDuration:l.preApplyArgsFn(y,a)}},d=function(a){return{xml:a,getAdaptationSets:l.preApplyArgsFn(j,a,"AdaptationSet",e),getAdaptationSetByType:function(b){return i(b,a)},getMpd:l.preApplyArgsFn(k,a,"MPD",c)}},e=function(a){return{xml:a,getRepresentations:l.preApplyArgsFn(j,a,"Representation",f),getSegmentTemplate:function(){return g(x(a))},getPeriod:l.preApplyArgsFn(k,a,"Period",d),getMpd:l.preApplyArgsFn(k,a,"MPD",c),getMimeType:l.preApplyArgsFn(v,a)}},f=function(a){return{xml:a,getSegmentTemplate:function(){return g(x(a))},getAdaptationSet:l.preApplyArgsFn(k,a,"AdaptationSet",e),getPeriod:l.preApplyArgsFn(k,a,"Period",d),getMpd:l.preApplyArgsFn(k,a,"MPD",c),getId:l.preApplyArgsFn(z,a),getWidth:l.preApplyArgsFn(s,a),getHeight:l.preApplyArgsFn(t,a),getFrameRate:l.preApplyArgsFn(u,a),getBandwidth:l.preApplyArgsFn(A,a),getCodecs:l.preApplyArgsFn(w,a),getBaseUrl:l.preApplyArgsFn(o,a),getMimeType:l.preApplyArgsFn(v,a)}},g=function(a){return{xml:a,getAdaptationSet:l.preApplyArgsFn(k,a,"AdaptationSet",e),getPeriod:l.preApplyArgsFn(k,a,"Period",d),getMpd:l.preApplyArgsFn(k,a,"MPD",c),getInitialization:l.preApplyArgsFn(B,a),getMedia:l.preApplyArgsFn(C,a),getDuration:l.preApplyArgsFn(D,a),getTimescale:l.preApplyArgsFn(E,a),getPresentationTimeOffset:l.preApplyArgsFn(F,a),getStartNumber:l.preApplyArgsFn(G,a)}},i=function(a,b){for(var c,d,f,g=b.getElementsByTagName("AdaptationSet"),h=0;h<g.length;h++)if(c=g.item(h),d=c.getElementsByTagName("Representation")[0],f=v(d),f&&f.indexOf(a)>=0)return e(c);return null},h=function(a){return j(a,"MPD",c)[0]},j=function(a,b,c){var d=Array.prototype.slice.call(a.getElementsByTagName(b));if("function"==typeof c){var e=d.map(c);return e}return d},k=function(a,b,c){return b&&a&&a.parentNode&&a.parentNode.hasOwnProperty("nodeName")?a.parentNode.nodeName===b?"function"==typeof c?c(a.parentNode):a.parentNode:k(a.parentNode,b,c):null},b.exports=h},{"../../xmlfun.js":17,"./util.js":6}],6:[function(a,b){"use strict";var c,d,e=31536e3,f=2592e3,g=86400,h=3600,i=60,j=/^P(([\d.]*)Y)?(([\d.]*)M)?(([\d.]*)D)?T?(([\d.]*)H)?(([\d.]*)M)?(([\d.]*)S)?/;c=function(a){return"string"!=typeof a?"":-1===a.indexOf("/")?"":(-1!==a.indexOf("?")&&(a=a.substring(0,a.indexOf("?"))),a.substring(0,a.lastIndexOf("/")+1))},d=function(a){var b=j.exec(a);return parseFloat(b[2]||0)*e+parseFloat(b[4]||0)*f+parseFloat(b[6]||0)*g+parseFloat(b[8]||0)*h+parseFloat(b[10]||0)*i+parseFloat(b[12]||0)};var k={parseRootUrl:c,parseMediaPresentationDuration:d};b.exports=k},{}],7:[function(a,b){"use strict";function c(a){return a&&a.getSegmentTemplate()?d(a):void 0}var d,e,f,g,h,i,j,k,l,m,n=a("../../xmlfun.js"),o=a("../mpd/util.js").parseMediaPresentationDuration,p=a("./segmentTemplate");g=function(a){var b=a.getCodecs(),c=a.getMimeType(),d=b.split(".").map(function(a){return a.replace(/^0+(?!\.|$)/,"")}),e=d.join(".");return c+';codecs="'+e+'"'},h=function(a){return Number(a.getBandwidth())},i=function(a){var b=a.getMpd().getMediaPresentationDuration(),c=Number(o(b)),d=Number(a.getSegmentTemplate().getPresentationTimeOffset());return Number(c-d)},j=function(a){var b=a.getSegmentTemplate();return Number(b.getDuration())/Number(b.getTimescale())},k=function(a){return Math.ceil(i(a)/j(a))},l=function(a){return Number(a.getSegmentTemplate().getStartNumber())},m=function(a){return k(a)+l(a)-1},d=function(a){return{getType:n.preApplyArgsFn(g,a),getBandwidth:n.preApplyArgsFn(h,a),getTotalDuration:n.preApplyArgsFn(i,a),getSegmentDuration:n.preApplyArgsFn(j,a),getTotalSegmentCount:n.preApplyArgsFn(k,a),getStartNumber:n.preApplyArgsFn(l,a),getEndNumber:n.preApplyArgsFn(m,a),getInitialization:function(){var b={};return b.getUrl=function(){var b=a.getBaseUrl(),c=a.getId(),d=a.getSegmentTemplate().getInitialization(),e=p.replaceIDForTemplate(d,c);return b+e},b},getSegmentByNumber:function(b){return e(a,b)},getSegmentByTime:function(b){return f(a,b)}}},e=function(a,b){var c={};return c.getUrl=function(){var c=a.getBaseUrl(),d=a.getSegmentTemplate().getMedia(),e=p.replaceIDForTemplate(d,a.getId()),f=p.replaceTokenForTemplate(e,"Number",b);return c+f},c.getStartTime=function(){return b*j(a)},c.getDuration=function(){return j(a)},c.getNumber=function(){return b},c},f=function(a){var b=j(a),c=Math.floor(i(a)/b),d=e(a,c);return d},b.exports=c},{"../../xmlfun.js":17,"../mpd/util.js":6,"./segmentTemplate":8}],8:[function(a,b){"use strict";var c,d,e,f,g;d=function(a,b){for(;a.length<b;)a="0"+a;return a},e=function(a,b,c){for(var e,f,g,h,i=0,j=0,k=b.length,l="%0",m=l.length;;){if(i=a.indexOf("$"+b),0>i)return a;if(j=a.indexOf("$",i+k),0>j)return a;if(e=a.indexOf(l,i+k),e>i&&j>e)switch(f=a.charAt(j-1),g=parseInt(a.substring(e+m,j-1),10),f){case"d":case"i":case"u":h=d(c.toString(),g);break;case"x":h=d(c.toString(16),g);break;case"X":h=d(c.toString(16),g).toUpperCase();break;case"o":h=d(c.toString(8),g);break;default:return console.log("Unsupported/invalid IEEE 1003.1 format identifier string in URL"),a}else h=c;a=a.substring(0,i)+h+a.substring(j+1)}},f=function(a){return a.split("$$").join("$")},g=function(a,b){if(null===b||-1===a.indexOf("$RepresentationID$"))return a;var c=b.toString();return a.split("$RepresentationID$").join(c)},c={zeroPadToLength:d,replaceTokenForTemplate:e,unescapeDollarsInTemplate:f,replaceIDForTemplate:g},b.exports=c},{}],9:[function(a,b){"use strict";var c=a("./eventManager.js"),d={trigger:function(a){c.trigger(this,a)},one:function(a,b){c.one(this,a,b)},on:function(a,b){c.on(this,a,b)},off:function(a,b){c.off(this,a,b)}};b.exports=d},{"./eventManager.js":10}],10:[function(a,b){"use strict";var c=a("../window.js").videojs,d={trigger:c.trigger,one:c.one,on:c.on,off:c.off};b.exports=d},{"../window.js":16}],11:[function(a){(function(){"use strict";function b(a){var b="",c="maybe",e=b;return d.MediaSource?/application\/dash\+xml/.test(a.type)?(console.log("matched type"),c):/\.mpd$/i.test(a.src)?(console.log("matched extension"),c):e:b}function c(a,b){return new f(a,b)}var d=a("./window"),e=d.videojs,f=(a("mse.js/src/js/mse.js"),a("./SourceHandler"));if(!e)throw new Error("The video.js library must be included to use this MPEG-DASH source handler.");e.Html5.registerSourceHandler({canHandleSource:b,handleSource:c},0)}).call(this)},{"./SourceHandler":4,"./window":16,"mse.js/src/js/mse.js":2}],12:[function(a,b){"use strict";function c(a,b){var c,e=(d(a),new XMLHttpRequest);c=function(){e.status<200||e.status>299||"function"==typeof b&&b({manifestXml:e.responseXML})};try{e.onload=c,e.open("GET",a,!0),e.send()}catch(f){e.onerror()}}var d=a("../dash/mpd/util.js").parseRootUrl;b.exports=c},{"../dash/mpd/util.js":6}],13:[function(a,b){function c(a,b){this.__adaptationSet=a,this.__currentRepresentation=a.getRepresentations()[0],this.__currentSegmentNumber=b}var d,e=a("../util/extendObject.js"),f=a("../events/EventDispatcherMixin.js"),g=a("../dash/segments/getSegmentListForRepresentation.js"),h=3,i=250;d=function(a,b,c,e){var f=new XMLHttpRequest;f.open("GET",a.getUrl(),!0),f.responseType="arraybuffer",f.onload=function(){return f.status<200||f.status>299?(console.log("Failed to load Segment @ URL: "+a.getUrl()),void(c>0?setTimeout(function(){d(a,b,c-1,e)},e):console.log("FAILED TO LOAD SEGMENT EVEN AFTER RETRIES"))):void("function"==typeof b&&b(f.response))},f.onerror=function(){console.log("Failed to load Segment @ URL: "+a.getUrl()),c>0?setTimeout(function(){d(a,b,c-1,e)},e):console.log("FAILED TO LOAD SEGMENT EVEN AFTER RETRIES")},f.send()},c.prototype.eventList={INITIALIZATION_LOADED:"initializationLoaded",SEGMENT_LOADED:"segmentLoaded"},c.prototype.getCurrentRepresentation=function(){return this.__currentRepresentation},c.prototype.setCurrentRepresentation=function(a){this.__currentRepresentation=a},c.prototype.getCurrentSegment=function(){var a=g(this.__currentRepresentation),b=a.getSegmentByNumber(this.__currentSegmentNumber);return b},c.prototype.setCurrentRepresentationByIndex=function(a){var b=this.__adaptationSet.getRepresentations();if(0>a||a>=b.length)throw new Error("index out of bounds");this.__currentRepresentation=b[a]},c.prototype.getCurrentSegmentNumber=function(){return this.__currentSegmentNumber},c.prototype.getStartSegmentNumber=function(){return g(this.__currentRepresentation).getStartNumber()},c.prototype.getEndSegmentNumber=function(){return g(this.__currentRepresentation).getEndNumber()},c.prototype.loadInitialization=function(){var a=this,b=g(this.__currentRepresentation),c=b.getInitialization();return c?(d.call(this,c,function(b){var c=new Uint8Array(b);a.trigger({type:a.eventList.INITIALIZATION_LOADED,target:a,data:c})}),!0):!1},c.prototype.loadNextSegment=function(){var a=null===this.__currentSegmentNumber||void 0===this.__currentSegmentNumber,b=a?0:this.__currentSegmentNumber+1;return this.loadSegmentAtNumber(b)},c.prototype.loadSegmentAtNumber=function(a){var b=this,c=g(this.__currentRepresentation);if(a>c.getEndNumber())return!1;var e=c.getSegmentByNumber(a);return d.call(this,e,function(a){b.__currentSegmentNumber=e.getNumber();var c=new Uint8Array(a);b.trigger({type:b.eventList.SEGMENT_LOADED,target:b,data:c})},h,i),!0},c.prototype.loadSegmentAtTime=function(a){var b=this,c=g(this.__currentRepresentation);if(a>c.getTotalDuration())return!1;var e=c.getSegmentByTime(a);return d.call(this,e,function(a){b.__currentSegmentNumber=e.getNumber();var c=new Uint8Array(a);b.trigger({type:b.eventList.SEGMENT_LOADED,target:b,data:c})},h,i),!0},e(c.prototype,f),b.exports=c},{"../dash/segments/getSegmentListForRepresentation.js":7,"../events/EventDispatcherMixin.js":9,"../util/extendObject.js":15}],14:[function(a,b){"use strict";function c(a,b){"append"in a?a.append(b):"appendBuffer"in a&&a.appendBuffer(b)}function d(a){if(!a)throw new Error("The sourceBuffer constructor argument cannot be null.");var b=this,d=[];a.addEventListener("updateend",function(a){return a.target.updating?void 0:(b.trigger({type:b.eventList.SEGMENT_ADDED_TO_BUFFER,target:b}),d.length<=0?void b.trigger({type:b.eventList.QUEUE_EMPTY,target:b}):void c(a.target,d.shift()))}),this.__dataQueue=d,this.__sourceBuffer=a}var e=a("../util/extendObject.js"),f=a("../events/EventDispatcherMixin.js");d.prototype.eventList={QUEUE_EMPTY:"queueEmpty",SEGMENT_ADDED_TO_BUFFER:"segmentAddedToBuffer"},d.prototype.addToQueue=function(a){0!==this.__dataQueue.length||this.__sourceBuffer.updating?this.__dataQueue.push(a):c(this.__sourceBuffer,a)},d.prototype.clearQueue=function(){this.__dataQueue=[]},e(d.prototype,f),b.exports=d},{"../events/EventDispatcherMixin.js":9,"../util/extendObject.js":15}],15:[function(a,b){"use strict";var c=function(a){return Array.prototype.slice.call(arguments,1).forEach(function(b){if(b)for(var c in b)a[c]=b[c]}),a};b.exports=c},{}],16:[function(a,b){b.exports=a(3)},{"/Users/cpillsbury/dev/JavaScript/VideoJSHtml5DashWorkspace/vjs-html5-dash/node_modules/mse.js/src/js/window.js":3}],17:[function(a,b){"use strict";function c(a){return null!==a}function d(a){return a!==!1&&c(a)}function e(a){var b=Array.prototype.slice.call(arguments,1);return function(){return a.apply(null,b)}}var f="[object Function]",g="[object String]",h=Object.prototype.toString,i=function(a){return"function"==typeof a};i(/x/)&&(i=function(a){return"function"==typeof a&&h.call(a)===f});var j=function(a){return"string"==typeof a||a&&"object"==typeof a&&h.call(a)===g||!1},k=function(a,b){var d=[];return i(b)||(b=function(){return!1}),function e(a){b(a,d)||c(a)&&c(a.parentNode)&&(d.push(a.parentNode),e(a.parentNode))}(a),d},l=function(a){return function(b){return b.getElementsByTagName(a)}},m=function(a,b){return"string"!=typeof a||""===a?void 0:function(d){return c(d)&&c(d.hasAttribute)&&c(d.getAttribute)?c(b)?d.getAttribute(a)===b:d.hasAttribute(a):!1}},n=function(a){return j(a)?function(b){return c(b)&&i(b.getAttribute)?b.getAttribute(a):void 0}:void 0},o=function(a){return j(a)&&""!==a?function b(d){return c(d)&&c(d.hasAttribute)&&c(d.getAttribute)?d.hasAttribute(a)?d.getAttribute(a):c(d.parentNode)?b(d.parentNode):void 0:void 0}:void 0},p=function(a,b){return j(a)&&""!==a?(i(b)||(b=function(){return!1}),function d(e){if(!c(e)||!c(e.getElementsByTagName))return void 0;if(b(e))return void 0;var f=e.getElementsByTagName(a);return c(f)&&f.length>0?f[0]:c(e.parentNode)?d(e.parentNode):void 0}):void 0},q={};q.existy=c,q.truthy=d,q.getNodeListByName=l,q.hasMatchingAttribute=m,q.getInheritableAttribute=o,q.getAncestors=k,q.getAttrFn=n,q.preApplyArgsFn=e,q.getInheritableElement=p,b.exports=q},{}]},{},[11]);